<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Honeycare Pharmacy || Cart</title>
    <link rel="stylesheet" href="/css/general.css" />
    <link rel="stylesheet" href="/css/cart.css" />
  </head>
  <body>
    <nav>
      <div class="nav-ctn">
        <a href="/">
          <div class="brand-name">
            <span class="green1"> Honeycare </span> 
            <span class="blue1"> Pharmacy and Beauty Hub </span>
          </div>
        </a>
        <div class="brand-logo">
          <a href="/">
            <img
            src="/img/logo/logo.png"
            alt="Honeycare pharmacy and Beauty Hub Logo"
          />
          </a>
        </div>
        <div class="flex">
            <div class="search-div">
                    <label class="search">
                        <svg xmlns="http://www.w3.org/2000/svg" width="31.042" height="28.512" viewBox="0 0 31.042 28.512">
                            <g id="Group_118" data-name="Group 118" transform="translate(1.5 1.5)">
                                <path id="Path_1" data-name="Path 1" d="M25.816,14.119c0,5.313-4.772,9.619-10.658,9.619S4.5,19.432,4.5,14.119,9.272,4.5,15.158,4.5,25.816,8.807,25.816,14.119Z" transform="translate(-4.5 -4.5)" fill="none" stroke="var(--green)" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/>
                                <path id="Path_2" data-name="Path 2" d="M34.148,33.5l-9.173-8.53" transform="translate(-6.727 -8.613)" fill="none" stroke="var(--green)" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/>
                            </g>
                        </svg>
                    </label>
                    <input type="search" placeholder="Cosmetics, Drugs ">

                </div>
        <a href="/cart">
          <div class="nav-extra">
            <label for="cart" class="bg-green1" id="cart-notice">1</label>
          <img src="/img/icons/Icon feather-shopping-cart.png" alt="" />
        </div>
        </a>
        </div>
                
            <!-- </div> -->
            </div>
            <div class="float">
                    <input type="search" placeholder="Cosmetics, Drugs" >
            </div>
    </nav>

    <section class="width">
      <div class="grid-2">
        <div class="left">
          <h2>Shopping Cart</h2>
          <div class="cart">
            <div class="cart-header">
              <span>Product</span>
              <span>Quantity</span>
              <span>Price</span>
              <span class="hide-on-small">Total Price</span>
            </div>
            <div class="cart-items" id="cart-items">
              <img src="/img/advise/advise1-small.png" alt="">
            </div>
            <div class="cart-bottom grid-2">
                <div class="bottom-left">
                    <div class="border-btn" onclick="continueshopping()"> <span><</span> Continue  Shopping</div>
                </div>
                <div class="bottom-right">
                    <div class="subtotal">
                        <span>Subtotal:</span>
                        <div id="total">N0</div>
                    </div>
                </div>
            </div>
          </div>
        </div>
        <div class="right">
            <h3>Ready to get these products?</h3>
            <!-- <div class="btn btn-primary">Send me these</div> -->

            <div class="payment">
              <!-- <h4>Honeycare PnB Payment</h4>
              <div class="price">5,000</div>
              <div class="steps">

              </div> -->
              <form action="" id="customer-details">
                <!-- <label>Enter Delivery Details</label> -->
                <label for="customer-name">Enter Your Name</label>
                <input type="text" name="customer-name" required id="name" placeholder="John Doe" value="lorem">
                <label for="customer-email">Enter Your Email</label>
                <input type="email" name="customer-email" required id="email" placeholder="JohnDoe@gmail.com" value="JohnDoe@gmail.com">
                <label for="customer-number">Enter Your Phone Number</label>
                <input type="number" name="customer-number" required id="number" placeholder="080345xxxxx" value="080345">
                <label for="customer-address">Enter Your Address</label>
                <textarea name="customer-address" required id="address" cols="30" rows="5" placeholder="include Landmarks, state, city pls" value="080345"></textarea>
                <button type="submit" class="">Send it Now</button>
              </form>
              <!-- <form action="" id="payment-form">
                <label>Enter card Details</label>
                <label for="card-number">Enter card Number</label>
                <input type="number" name="card-number" id="" placeholder="5355-XXXX-XXXX-XXXX" required>
                <div class="grid-2">
                  <div class="">
                    <label for="card-name">Expiry Date</label>
                    <input type="number" name="card-name" id="" maxlength="5" placeholder="04/24" required>
                  </div>
                  <div class="">
                    <label for="card-name">cvv</label>
                    <input type="number" name="card-name" id="" minlength="3" maxlength="3" placeholder="123" required>
                  </div>
                </div>
                <button type="submit" class="">Verify and Pay</button>
              </form> -->
              <!-- <form action="" id="payment-form">
                <label class="center">OTP</label>
                <label for="">Enter OTP code</label>
                <input type="number" name="card-otp" id="" placeholder="3" required>
                <input type="number" name="card-otp" id="" placeholder="3" required>
                <input type="number" name="card-otp" id="" placeholder="3" required>
                <input type="number" name="card-otp" id="" placeholder="3" required>
                <input type="number" name="card-otp" id="" placeholder="3" required>
                
                <button type="submit" class="">Verify</button>
              </form> -->
            </div>
        </div>
      </div>
    </section>

    <script>
      String.prototype.escape = function () {
            var tagtoreplace = {
                "&": "&amp;",
                "<": "&lt",
                ">": "&gt",
                "=": "",
                "script": " ",
                "Script": " ",
                '"': " ",
                "`": " "
            };
            return this.replace(/[&<>`=]/g, function (tag) {
                return tagtoreplace[tag] || tag;
            });
        }
       
      function continueshopping(){
        window.history.back();
      }
      var products = JSON.parse(localStorage.getItem("honeycareproduct"));
      document.getElementById("customer-details").addEventListener("submit", pay);
      function pay(e){
        e.preventDefault();
        if(products){
          var name = e.target[0].value.escape();
          var email = e.target[1].value.escape();
          var number = e.target[2].value;
          var address = e.target[3].value.escape();
          var productBought =  getprod();
          if(name.trim().length > 4){
            if(number.trim().length> 9 && number.trim().length< 16){
                if(address.trim().length> 5){
                  var data = {name,email,number,address,productBought};
                  fetch("/pay", {
                    method: "POST",
                    headers: {"Content-Type": "application/json"},
                    body: JSON.stringify(data)
                  }).then(res=> res.json()).then(message=> {alert(message.message); document.getElementById("customer-details").reset()})
                  .catch(err=>{console.error(err)});
              }
              else{
                alert("Pls enter accurate address")
              }
            }
            else{
              alert("Pls enter a valid phone number ")
            }
          }else{
            alert("Pls enter a valid name")
          }
        }

      }
      function getprod(){

        if(products){
          var prod = [];
          Object.values(products).forEach((product) => {
            prod.push({
              id: product._id,
              category: product.category,
              subcategory: product.subcategory,
              incart: product.incart
            })
          });
          return prod;
        }
      }

    </script>
    <script src="/js/general.js"></script>
  </body>
</html>
